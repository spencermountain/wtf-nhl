!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).wtfNhl=n()}(this,(function(){"use strict";var e=["Boston Bruins","Buffalo Sabres","Detroit Red Wings","Florida Panthers","Montreal Canadiens","Ottawa Senators","Tampa Bay Lightning","Toronto Maple Leafs","Carolina Hurricanes","Columbus Blue Jackets","New Jersey Devils","New York Islanders","New York Rangers","Philadelphia Flyers","Pittsburgh Penguins","Washington Capitals","Chicago Blackhawks","Colorado Avalanche","Dallas Stars","Minnesota Wild","Nashville Predators","St. Louis Blues","Winnipeg Jets","Anaheim Ducks","Arizona Coyotes","Calgary Flames","Edmonton Oilers","Los Angeles Kings","San Jose Sharks","Vancouver Canucks","Vegas Golden Knights"],n=function(e){var n=0;return e.forEach((function(e){e.record.wins>n?(e.win=!0,n=e.record.wins):e.record.wins===n?e.win=null:e.win=!1;var t=e.result;e.win?e.result={us:t.win,them:t.loss}:e.result={us:t.loss,them:t.win}})),e},t=/(–|-|−|&ndash;)/,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=e.split(t),r={wins:Number(n[0])||0,losses:Number(n[2])||0,ties:Number(n[4])||0};return r.games=r.wins+r.losses+r.ties,r},o=/(–|-|−|&ndash;)/,s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=e.split(o);return n[0]||n[2]?{win:Number(n[0]),loss:Number(n[2])}:{}},a=function(e,n){var t=n.year,r=e.date||e.Date;return r?(/^(jan|feb|mar|apr)/i.test(r)?r+=" "+(t+1):r+=" "+t,r):""},i=function(e,t){var o=[],i=e.sections("regular season")||e.sections("schedule and results");if(!i)return o;var u=i.tables();return i.children().forEach((function(e){u=u.concat(e.tables())})),u[0]?(u.forEach((function(e){e.keyValue().forEach((function(e){o.push(function(e,n){var t=e.attendance||e.Attendance||"";t=Number(t.replace(/,/,""))||null;var o={game:Number(e["#"]||e.Game),date:a(e,n),opponent:e.Opponent,result:s(e.score||e.Score),overtime:"ot"===(e.ot||e.OT||"").toLowerCase(),record:r(e.record||e.Record),attendance:t,points:Number(e.pts||e.points||e.Pts||e.Points)||0};return o.location=e.Location,o.home=e.home||e.Home,o.visitor=e.visitor||e.Visitor,o.opponent||(o.opponent=n.team.includes(o.home)?o.visitors:o.home),o.opponent=o.opponent||"",o.opponent=o.opponent.replace(/\@ /,""),o.opponent=o.opponent.trim(),o}(e,t))}))})),o=o.filter((function(e){return e&&e.date})),o=function(e){return e.forEach((function(e){e.attendance||e.points||e.record.wins||e.record.lossess||e.record.ties||(e.inFuture=!0,e.win=null)})),e}(o=n(o))):o},u=/([0-9])(st|nd|rd|th)$/i,c=function(e){var n=e.infobox("ice hockey team season")[0]||e.infobox("NHLTeamSeason")[0];if(!n)return{};var t=n.keyValue();return Object.keys(t).forEach((function(e){t[e]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e=e.trim(),u.test(e)?(e=e.replace(u,"$1"),Number(e)):/^[0-9]+$/.test(e)?Number(e):e}(t[e])})),t.record&&(t.record=r(t.record)),t},l=function(e){var n=e.sections("skaters")||e.sections("roster")||e.sections("player statistics"),t=[];if(!n)return t;var r=n.tables();return n.children().forEach((function(e){r=r.concat(e.tables())})),r[0]?t=(t=r[0].keyValue().map((function(e){var n=e.Player||"";return{name:n=(n=(n=n.replace(/\(.*?\)/,"")).replace(/[‡†]/,"")).trim(),games:Number(e.GP||0),goals:Number(e.G||0),assists:Number(e.A||0),points:Number(e.Pts||e.PTS||e.Points)||0,plusMinus:Number(e["+/−"])||0}}))).filter((function(e){return e&&e.name&&"Total"!==e.name})):t},f=function(e){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=e.match(/[0-9]+/)||[],t=Number(n[0])||e,r=e.replace(/[0-9\-–]+/,"").replace(/_/g," ").replace(" season","");return{year:t,season:e,team:r.trim()}}(e.title()),t={team:n.team,year:n.year,page:n.season,roster:l(e),season:c(e)};return t.games=i(e,n),t};return function(n){n.wtf.getSeason=function(t,r){var o=function(e,n){e=e.replace(/ /g,"_"),n=n||(new Date).getFullYear();var t=Number(String(n).substr(2,4))+1;return"".concat(n,"–").concat(t,"_").concat(e,"_season")}(t=e.find((function(e){return e===t||e.toLowerCase().includes(t.toLowerCase())}))||t,r);return n.wtf.fetch(o).catch(console.log).then(f)}}}));
